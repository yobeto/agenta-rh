(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2601:function(e,t,r){"use strict";var o,n;e.exports=(null==(o=r.g.process)?void 0:o.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(8960)},305:function(e,t,r){Promise.resolve().then(r.t.bind(r,2445,23)),Promise.resolve().then(r.bind(r,2406))},2406:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return f},useAuth:function(){return h}});var o=r(7437),n=r(2265),i=r(4033),a=r(2601);let c=(0,n.createContext)(void 0),u=a.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",s="agente-rh-token",l="agente-rh-user";function f(e){let{children:t}=e,[r,a]=(0,n.useState)(null),[f,h]=(0,n.useState)(null),[d,p]=(0,n.useState)(!0),m=(0,i.useRouter)();(0,n.useEffect)(()=>{let e=localStorage.getItem(s),t=localStorage.getItem(l);if(e&&t)try{h(e),a(JSON.parse(t))}catch(e){console.error("Error parsing stored user:",e),localStorage.removeItem(s),localStorage.removeItem(l)}p(!1)},[]);let v=async(e,t)=>{try{let n;let i=new AbortController,c=setTimeout(()=>{i.abort()},3e4);try{n=await fetch("".concat(u,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t}),signal:i.signal}),clearTimeout(c)}catch(e){var r,o;if(clearTimeout(c),"AbortError"===e.name)throw Error("La petici\xf3n tard\xf3 demasiado. El servidor puede estar lento o no disponible.");if((null===(r=e.message)||void 0===r?void 0:r.includes("Failed to fetch"))||(null===(o=e.message)||void 0===o?void 0:o.includes("NetworkError")))throw Error("No se pudo conectar con el servidor. Verifica que el backend est\xe9 funcionando.");throw e}if(!n.ok){let e="Error al iniciar sesi\xf3n";try{e=(await n.json()).detail||e}catch(t){e="Error ".concat(n.status,": ").concat(n.statusText)}throw Error(e)}let f=await n.json();localStorage.setItem(s,f.access_token),localStorage.setItem(l,JSON.stringify(f.user)),document.cookie="agente-rh-token=".concat(f.access_token,"; path=/; max-age=").concat(28800,"; SameSite=Lax"),h(f.access_token),a(f.user),await new Promise(e=>setTimeout(e,100)),window.location.href="/"}catch(e){throw console.error("Login error:",e),e}};return(0,o.jsx)(c.Provider,{value:{user:r,token:f,login:v,logout:()=>{localStorage.removeItem(s),localStorage.removeItem(l),document.cookie="agente-rh-token=; path=/; max-age=0",h(null),a(null),m.push("/login")},isLoading:d,isAuthenticated:!!f&&!!r},children:t})}function h(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2445:function(){},8960:function(e){!function(){var t={229:function(e){var t,r,o,n=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u=[],s=!1,l=-1;function f(){s&&o&&(s=!1,o.length?u=o.concat(u):l=-1,u.length&&h())}function h(){if(!s){var e=c(f);s=!0;for(var t=u.length;t;){for(o=u,u=[];++l<t;)o&&o[l].run();l=-1,t=u.length}o=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new d(e,t)),1!==u.length||s||c(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}},a=!0;try{t[e](i,i.exports,o),a=!1}finally{a&&delete r[e]}return i.exports}o.ab="//";var n=o(229);e.exports=n}()},622:function(e,t,r){"use strict";var o=r(2265),n=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function s(e,t,r){var o,i={},s=null,l=null;for(o in void 0!==r&&(s=""+r),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(l=t.ref),t)a.call(t,o)&&!u.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:n,type:e,key:s,ref:l,props:i,_owner:c.current}}t.Fragment=i,t.jsx=s,t.jsxs=s},7437:function(e,t,r){"use strict";e.exports=r(622)},4033:function(e,t,r){e.exports=r(5313)}},function(e){e.O(0,[971,938,744],function(){return e(e.s=305)}),_N_E=e.O()}]);