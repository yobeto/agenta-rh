(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1035:function(e,a,s){Promise.resolve().then(s.bind(s,150))},150:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return en}});var t=s(7437),r=s(2265),i=s(6691),n=s.n(i),l=s(4829);let o=s(2601).env.NEXT_PUBLIC_API_URL||"http://localhost:8000",c=l.Z.create({baseURL:o,headers:{"Content-Type":"application/json"}});async function d(e){return(await c.post("/api/analyze",e)).data}async function u(e){let a=new FormData;a.append("file",e);let s=localStorage.getItem("agente-rh-token"),t={"Content-Type":"multipart/form-data"};return s&&(t.Authorization="Bearer ".concat(s)),(await l.Z.post("".concat(o,"/api/extract-text"),a,{headers:t})).data}async function m(e){return(await c.post("/api/chat",e)).data}async function h(e){return(await c.post("/api/auth/create-user",e)).data}async function p(e){return(await c.post("/api/candidates/action",e)).data}async function x(e){return(await c.get("/api/audit/log",{params:e})).data}c.interceptors.request.use(e=>{{let a=localStorage.getItem("agente-rh-token");a&&(e.headers.Authorization="Bearer ".concat(a))}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>e,e=>{var a;return(null===(a=e.response)||void 0===a?void 0:a.status)===401&&(localStorage.removeItem("agente-rh-token"),localStorage.removeItem("agente-rh-user"),window.location.href="/login"),Promise.reject(e)});var g=s(8395),j=s(5750),v=s(1138),b=s(3715),f=s(3157),y=s(4631);let N={ready:"Listo",loading:"Procesando",error:"Revisar"};function _(e){let{onCandidatesChange:a,onSummaryChange:s}=e,[i,n]=(0,r.useState)([]),l=e=>{a(e.filter(e=>"ready"===e.status&&e.content).map(e=>({filename:e.filename,content:e.content,candidateId:e.filename.replace(/\.pdf$/i,"").replace(/[^a-zA-Z0-9]+/g,"-").replace(/^-+|-+$/g,"").toLowerCase()||void 0}))),s&&s(e.reduce((e,a)=>(e.total+=1,"ready"===a.status&&(e.ready+=1),"loading"===a.status&&(e.loading+=1),"error"===a.status&&(e.errors+=1),e),{total:0,ready:0,loading:0,errors:0}))},o=async e=>{let a=e.target.files;if(!(null==a?void 0:a.length))return;let s=[],t=[...i];for(let e of Array.from(a)){if("application/pdf"!==e.type){s.push({id:"".concat(e.name,"-").concat(Date.now()),filename:e.name,status:"error",content:"",warnings:[],errorMessage:"Solo se aceptan archivos PDF (.pdf)."});continue}let a={id:"".concat(e.name,"-").concat(Date.now(),"-").concat(Math.random()),filename:e.name,status:"loading",content:"",warnings:[]};t.push(a),n([...t]);try{let{text:s,warnings:t}=await u(e);a.status="ready",a.content=s.slice(0,15e3),a.warnings=t||[]}catch(e){var r,o;a.status="error",a.errorMessage=(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(r=o.data)||void 0===r?void 0:r.detail)||"No fue posible procesar el PDF."}n([...t]),l(t)}if(s.length>0){let e=[...t,...s];n(e),l(e)}e.target.value=""},c=e=>{let a=i.filter(a=>a.id!==e);n(a),l(a)},d=i.reduce((e,a)=>(e.total+=1,e[a.status]+=1,e),{total:0,ready:0,loading:0,error:0});return(0,t.jsxs)("section",{className:"card upload-card","aria-labelledby":"candidate-uploads",children:[(0,t.jsxs)("div",{className:"upload-card__header",children:[(0,t.jsx)("div",{className:"badge",children:"Paso 2"}),(0,t.jsx)("h2",{id:"candidate-uploads",className:"section-title",children:"CVs de candidatos"}),(0,t.jsx)("p",{children:"Procesa m\xfaltiples CVs en PDF para obtener una evaluaci\xf3n equilibrada y comparable."})]}),(0,t.jsxs)("label",{htmlFor:"candidate-upload-input",className:"upload-dropzone upload-dropzone--multiple",children:[(0,t.jsx)(g.Z,{size:24,"aria-hidden":"true"}),(0,t.jsx)("span",{className:"upload-dropzone__title",children:"Arrastra o selecciona uno o varios PDFs"}),(0,t.jsx)("span",{className:"upload-dropzone__hint",children:"Puedes cargar por lotes hasta 10 archivos"}),(0,t.jsx)("input",{id:"candidate-upload-input",type:"file",accept:"application/pdf",multiple:!0,onChange:o,className:"sr-only"})]}),(0,t.jsx)("div",{className:"upload-card__meta","aria-live":"polite",children:0===d.total?(0,t.jsx)("span",{children:"Consejo: selecciona varios CVs para comparar candidatos en un solo paso."}):(0,t.jsxs)("span",{children:[d.total," archivos \xb7 ",d.ready," listos \xb7 ",d.loading," procesando",d.error>0?" \xb7 ".concat(d.error," con aviso"):""]})}),(0,t.jsx)("div",{className:"candidate-list",children:i.map(e=>{let a=e.content.trim().split(/\s+/).filter(Boolean).length;return(0,t.jsxs)("article",{className:"candidate-item candidate-item--".concat(e.status),children:[(0,t.jsxs)("div",{className:"candidate-item__header",children:[(0,t.jsx)("div",{className:"candidate-item__avatar","aria-hidden":"true",children:(0,t.jsx)(j.Z,{size:18})}),(0,t.jsxs)("div",{className:"candidate-item__title",children:[(0,t.jsx)("h3",{children:e.filename}),(0,t.jsx)("span",{className:"candidate-item__tag candidate-item__tag--".concat(e.status),children:N[e.status]})]}),(0,t.jsx)("button",{type:"button",className:"candidate-item__remove",onClick:()=>c(e.id),"aria-label":"Quitar ".concat(e.filename),children:(0,t.jsx)(v.Z,{size:16})})]}),(0,t.jsxs)("div",{className:"candidate-item__body","aria-live":"polite",children:["loading"===e.status&&(0,t.jsxs)("div",{className:"candidate-item__progress",children:[(0,t.jsx)(b.Z,{size:16,className:"candidate-item__spinner"}),(0,t.jsx)("span",{children:"Extrayendo texto…"})]}),"ready"===e.status&&(0,t.jsxs)("div",{className:"candidate-item__success",children:[(0,t.jsx)(f.Z,{size:16}),(0,t.jsxs)("span",{children:[a," palabras extra\xeddas correctamente."]})]}),"error"===e.status&&(0,t.jsxs)("div",{className:"candidate-item__error",children:[(0,t.jsx)(y.Z,{size:16}),(0,t.jsx)("span",{children:e.errorMessage})]}),"ready"===e.status&&e.warnings.length>0&&(0,t.jsx)("ul",{className:"candidate-item__warnings",children:e.warnings.map((a,s)=>(0,t.jsx)("li",{children:a},"".concat(e.id,"-warning-").concat(s)))})]})]},e.id)})})]})}var w=s(4530),z=s(9806),S=s(6141),C=s(2549),k=s(2851),Z=s(6678),I=s(2406);let E={high:"Confianza alta",medium:"Confianza media",low:"Confianza baja",insufficient:"Confianza insuficiente"},P={high:92,medium:76,low:58,insufficient:45};function R(e){let{results:a}=e,{user:s}=(0,I.useAuth)(),[i,n]=(0,r.useState)({}),[l,o]=(0,r.useState)(new Set),[c,d]=(0,r.useState)({}),[u,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=localStorage.getItem("candidate-actions");if(e)try{d(JSON.parse(e))}catch(e){console.error("Error loading candidate actions:",e)}},[]),(0,r.useEffect)(()=>{Object.keys(c).length>0&&localStorage.setItem("candidate-actions",JSON.stringify(c))},[c]);let h=e=>{n(a=>({...a,[e]:!a[e]}))},x=e=>"".concat(e.filename,"-").concat(e.candidateId||"default"),g=e=>{o(a=>{let s=new Set(a);return s.has(e)?s.delete(e):s.add(e),s})},v=async(e,a,s)=>{try{await p({candidate_id:e,candidate_filename:s.filename,action:a}),d(s=>({...s,[e]:{candidateId:e,status:a}})),o(a=>{let s=new Set(a);return s.delete(e),s})}catch(s){console.error("Error registrando acci\xf3n:",s),d(s=>({...s,[e]:{candidateId:e,status:a}}))}},b=async e=>{let s={},t=[];l.forEach(r=>{let i=a.find(e=>x(e)===r);i&&t.push(p({candidate_id:r,candidate_filename:i.filename,action:e}).then(()=>{s[r]={candidateId:r,status:e}}).catch(a=>{console.error("Error registrando acci\xf3n para ".concat(r,":"),a),s[r]={candidateId:r,status:e}}))}),await Promise.all(t),d(e=>({...e,...s})),o(new Set),m(!1)},N=e=>{switch(e){case"interview":return"Pasar a entrevista";case"rejected":return"Rechazar";case"on_hold":return"En espera";default:return"Pendiente"}},_=e=>{switch(e){case"interview":return(0,t.jsx)(w.Z,{size:16});case"rejected":return(0,t.jsx)(z.Z,{size:16});case"on_hold":return(0,t.jsx)(S.Z,{size:16});default:return null}};return(0,t.jsxs)("section",{className:"card analysis-results","aria-labelledby":"analysis-result",children:[(0,t.jsxs)("div",{className:"analysis-results__head",children:[(0,t.jsx)("div",{className:"badge",children:"Resultados preliminares"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{id:"analysis-result",className:"section-title",children:"Insight generado por IA"}),(0,t.jsx)("p",{children:"Usa estas recomendaciones como gu\xeda objetiva. Verifica la informaci\xf3n con entrevistas y decisiones humanas antes de avanzar a la siguiente etapa."})]}),a.length>0&&(0,t.jsxs)("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",marginTop:"1rem"},children:[(0,t.jsx)("button",{type:"button",onClick:l.size===a.length?()=>{o(new Set),m(!1)}:()=>{o(new Set(a.map(e=>x(e)))),m(!0)},className:"btn-outline",style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:l.size===a.length?"Deseleccionar todos":"Seleccionar todos"}),l.size>0&&(0,t.jsxs)("span",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[l.size," candidato",1!==l.size?"s":""," seleccionado",1!==l.size?"s":""]})]})]}),u&&l.size>0&&(0,t.jsxs)("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1rem 1.5rem",background:"linear-gradient(135deg, rgba(0, 59, 113, 0.05), rgba(0, 168, 89, 0.03))",border:"1px solid rgba(0, 59, 113, 0.1)"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)(j.Z,{size:18}),(0,t.jsxs)("strong",{children:["Acciones en lote (",l.size," candidatos)"]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>m(!1),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem"},children:(0,t.jsx)(C.Z,{size:18})})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[(0,t.jsxs)("button",{type:"button",onClick:()=>b("interview"),className:"btn-primary",style:{fontSize:"0.875rem",padding:"0.625rem 1.25rem"},children:[(0,t.jsx)(w.Z,{size:16,style:{marginRight:"0.5rem"}}),"Pasar a entrevista"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>b("on_hold"),className:"btn-outline",style:{fontSize:"0.875rem",padding:"0.625rem 1.25rem"},children:[(0,t.jsx)(S.Z,{size:16,style:{marginRight:"0.5rem"}}),"En espera"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>b("rejected"),style:{fontSize:"0.875rem",padding:"0.625rem 1.25rem",background:"rgba(239, 68, 68, 0.1)",color:"#dc2626",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)(z.Z,{size:16}),"Rechazar"]})]})]}),(!a||0===a.length)&&(0,t.jsxs)("div",{className:"status-empty status-empty--accent",children:[(0,t.jsx)(k.Z,{size:20,"aria-hidden":"true"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"No hay an\xe1lisis disponibles todav\xeda."}),(0,t.jsx)("span",{children:"Cuando cargues los archivos y ejecutes el proceso, ver\xe1s aqu\xed un resumen por candidato."})]})]}),(0,t.jsx)("div",{className:"candidate-results",children:a.map(e=>{let a="".concat(e.filename,"-").concat(e.candidateId||"default"),s=!!i[a],r=function(e){let a=e.trim().replace(/\s+/g," ");if(a.length<=240)return a;let s=a.slice(0,240),t=s.lastIndexOf(".");return t>144?"".concat(s.slice(0,t+1)):"".concat(s,"…")}(e.recommendation),n=function(e){var a;let s=null!==(a=P[e.confidence_level])&&void 0!==a?a:70;return Math.max(30,Math.min(100,Math.round(s-(e.missing_information&&e.missing_information.length>0?10:0)+(e.objective_criteria.length>=3?5:0))))}(e),o=n>=85?"alto":n>=70?"medio":"bajo",d=[...e.objective_criteria].sort((e,a)=>{var s,t;return(null!==(s=a.weight)&&void 0!==s?s:0)-(null!==(t=e.weight)&&void 0!==t?t:0)}).slice(0,3).filter(e=>e.value),u=[];!1===e.ethical_compliance&&u.push("Requiere revisi\xf3n \xe9tica antes de avanzar."),e.missing_information&&e.missing_information.length>0&&u.push(...e.missing_information),0===u.length&&u.push("Sin alertas relevantes detectadas.");let p=e.missing_information&&e.missing_information.length>0?e.missing_information:["Profundiza en motivaciones y expectativas salariales.","Valida referencias laborales y logros cuantificables.","Asegura disponibilidad para los hitos cr\xedticos del puesto."],j=e.objective_criteria.reduce((e,a)=>void 0===a.weight||null===a.weight||Number.isNaN(a.weight)?e:e+Math.max(0,a.weight),0),b=x(e),C=l.has(b),k=c[b];return(0,t.jsxs)("article",{className:"candidate-result candidate-result--".concat(o),children:[(0,t.jsxs)("header",{className:"candidate-result__header",children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,t.jsx)("input",{type:"checkbox",checked:C,onChange:()=>{g(b),C||m(!0)},style:{width:"18px",height:"18px",cursor:"pointer"}}),(0,t.jsxs)("div",{className:"candidate-result__identity",children:[(0,t.jsxs)("div",{className:"candidate-result__score candidate-result__score--".concat(o),children:[(0,t.jsx)("span",{children:n}),(0,t.jsx)("small",{children:"/100"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{children:e.candidateId||e.filename}),(0,t.jsx)("p",{children:e.filename})]})]})]}),(0,t.jsxs)("div",{className:"candidate-result__chips",children:[(0,t.jsx)("span",{className:"chip chip--confidence-".concat(e.confidence_level),children:E[e.confidence_level]||"Confianza no disponible"}),(0,t.jsx)("span",{className:"chip chip--ethics-".concat(!1===e.ethical_compliance?"alert":"ok"),children:!1===e.ethical_compliance?"Requiere revisi\xf3n \xe9tica":"Cumplimiento \xe9tico"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[k&&(0,t.jsxs)("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"999px",background:"interview"===k.status?"rgba(0, 168, 89, 0.1)":"rejected"===k.status?"rgba(239, 68, 68, 0.1)":"rgba(148, 163, 184, 0.1)",color:"interview"===k.status?"#00a859":"rejected"===k.status?"#dc2626":"#64748b",display:"flex",alignItems:"center",gap:"0.25rem",fontWeight:600},children:[_(k.status),N(k.status)]}),(0,t.jsx)("button",{type:"button",className:"candidate-result__toggle",onClick:()=>h(a),children:s?"Ocultar detalles":"Ver detalles"})]})]}),(0,t.jsx)("p",{className:"candidate-result__summary",children:s?e.recommendation:r}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid rgba(148, 163, 184, 0.2)",flexWrap:"wrap"},children:[(0,t.jsxs)("button",{type:"button",onClick:()=>v(b,"interview",e),style:{fontSize:"0.875rem",padding:"0.5rem 1rem",background:(null==k?void 0:k.status)==="interview"?"rgba(0, 168, 89, 0.15)":"rgba(0, 168, 89, 0.08)",color:(null==k||k.status,"#00a859"),border:"1px solid ".concat((null==k?void 0:k.status)==="interview"?"#00a859":"rgba(0, 168, 89, 0.3)"),borderRadius:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:600,transition:"all 0.2s"},onMouseEnter:e=>{(null==k?void 0:k.status)!=="interview"&&(e.currentTarget.style.background="rgba(0, 168, 89, 0.12)")},onMouseLeave:e=>{(null==k?void 0:k.status)!=="interview"&&(e.currentTarget.style.background="rgba(0, 168, 89, 0.08)")},children:[(0,t.jsx)(w.Z,{size:16}),"Pasar a entrevista"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>v(b,"on_hold",e),style:{fontSize:"0.875rem",padding:"0.5rem 1rem",background:(null==k?void 0:k.status)==="on_hold"?"rgba(148, 163, 184, 0.15)":"rgba(148, 163, 184, 0.08)",color:(null==k?void 0:k.status)==="on_hold"?"#475569":"#64748b",border:"1px solid ".concat((null==k?void 0:k.status)==="on_hold"?"#94a3b8":"rgba(148, 163, 184, 0.3)"),borderRadius:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:600,transition:"all 0.2s"},children:[(0,t.jsx)(S.Z,{size:16}),"En espera"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>v(b,"rejected",e),style:{fontSize:"0.875rem",padding:"0.5rem 1rem",background:(null==k?void 0:k.status)==="rejected"?"rgba(239, 68, 68, 0.15)":"rgba(239, 68, 68, 0.08)",color:(null==k?void 0:k.status)==="rejected"?"#dc2626":"#ef4444",border:"1px solid ".concat((null==k?void 0:k.status)==="rejected"?"#ef4444":"rgba(239, 68, 68, 0.3)"),borderRadius:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:600,transition:"all 0.2s"},children:[(0,t.jsx)(z.Z,{size:16}),"Rechazar"]})]}),(0,t.jsxs)("div",{className:"candidate-result__highlights",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{children:"Fortalezas detectadas"}),(0,t.jsx)("ul",{children:d.length>0?d.map((e,s)=>(0,t.jsxs)("li",{children:[e.name,": ",e.value]},"".concat(a,"-strength-").concat(s))):(0,t.jsx)("li",{children:"No se identificaron fortalezas destacadas."})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{children:"Riesgos y alertas"}),(0,t.jsx)("ul",{children:u.map((e,s)=>(0,t.jsx)("li",{children:e},"".concat(a,"-risk-").concat(s)))})]})]}),s&&(0,t.jsxs)("div",{className:"candidate-result__details",children:[(0,t.jsxs)("div",{className:"candidate-result__panel",children:[(0,t.jsx)("h4",{children:"Criterios objetivos evaluados"}),0===e.objective_criteria.length&&(0,t.jsx)("p",{children:"No se proporcionaron criterios objetivos."}),e.objective_criteria.map((e,s)=>{let r=j>0&&void 0!==e.weight&&null!==e.weight?Math.round(Math.max(0,e.weight)/j*100):null;return(0,t.jsxs)("div",{className:"criterion-bar",children:[(0,t.jsxs)("div",{className:"criterion-bar__label",children:[(0,t.jsx)("strong",{children:e.name}),void 0!==e.weight&&null!==e.weight&&(0,t.jsxs)("span",{children:[Math.round(100*Math.max(0,e.weight)),"%"]})]}),(0,t.jsx)("p",{children:e.value}),null!==r&&(0,t.jsxs)("div",{className:"criterion-bar__track",children:[(0,t.jsx)("div",{style:{width:"".concat(Math.min(100,r),"%")}}),(0,t.jsxs)("span",{children:[r,"%"]})]})]},"".concat(a,"-criterion-").concat(s))})]}),(0,t.jsxs)("div",{className:"candidate-result__panel",children:[(0,t.jsx)("h4",{children:"Nivel de confianza"}),(0,t.jsxs)("div",{className:"confidence-card",children:[(0,t.jsx)(Z.Z,{size:18,"aria-hidden":"true"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:E[e.confidence_level]||"No disponible"}),(0,t.jsx)("span",{children:e.confidence_explanation})]})]}),(0,t.jsx)("h4",{children:"Seguimiento recomendado"}),(0,t.jsx)("ul",{className:"follow-up-list",children:p.map((e,s)=>(0,t.jsx)("li",{children:e},"".concat(a,"-follow-").concat(s)))})]}),(0,t.jsxs)("div",{className:"candidate-result__panel",children:[(0,t.jsx)("h4",{children:"Checklist para entrevista"}),(0,t.jsxs)("div",{className:"checklist-card",children:[(0,t.jsx)(f.Z,{size:18,"aria-hidden":"true"}),(0,t.jsx)("span",{children:"Confirma logros cuantificables y solicita evidencias de proyectos donde aplic\xf3 las competencias clave se\xf1aladas en el an\xe1lisis."})]}),(0,t.jsxs)("div",{className:"checklist-card checklist-card--warning",children:[(0,t.jsx)(y.Z,{size:18,"aria-hidden":"true"}),(0,t.jsx)("span",{children:"Atiende cualquier observaci\xf3n \xe9tica antes de avanzar el expediente del candidato a etapas finales."})]})]})]})]},a)})})]})}let A={idle:"Pendiente",loading:"Procesando",error:"Revisar",ready:"Listo"};function M(e){let{jobDescription:a,onJobDescriptionChange:s,onUploadStatusChange:i}=e,[n,l]=(0,r.useState)("idle"),[o,c]=(0,r.useState)(null),[d,m]=(0,r.useState)([]),[h,p]=(0,r.useState)(null),x=a?a.trim().split(/\s+/).filter(Boolean).length:0,j=async e=>{var a,t,r;let n=null===(a=e.target.files)||void 0===a?void 0:a[0];if(n){if("application/pdf"!==n.type){c("Solo se aceptan archivos PDF (.pdf)."),l("error"),null==i||i("error",{fileName:n.name});return}l("loading"),c(null),m([]),null==i||i("loading",{fileName:n.name});try{let{text:e,warnings:a}=await u(n),t=e.slice(0,12e3);s(t),m(a||[]),l("ready"),p(n.name);let r=t.trim().split(/\s+/).filter(Boolean).length;null==i||i("ready",{fileName:n.name,wordCount:r})}catch(e){l("error"),c((null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||"No fue posible leer el PDF. Intenta con otro archivo."),null==i||i("error",{fileName:n.name})}}};return(0,r.useEffect)(()=>{if(!a){null==i||i("idle");return}"loading"!==n&&(null==i||i("ready",{wordCount:x,fileName:null!=h?h:void 0}))},[a,n,x,h,i]),(0,t.jsxs)("section",{className:"card upload-card","aria-labelledby":"job-description",children:[(0,t.jsxs)("div",{className:"upload-card__header",children:[(0,t.jsx)("div",{className:"badge",children:"Paso 1"}),(0,t.jsx)("h2",{id:"job-description",className:"section-title",children:"Job Description (PDF)"}),(0,t.jsx)("p",{children:"La IA extrae autom\xe1ticamente los criterios clave de la posici\xf3n."})]}),(0,t.jsxs)("label",{htmlFor:"job-description-file",className:"upload-dropzone upload-dropzone--".concat(n),children:[(0,t.jsx)(g.Z,{size:24,"aria-hidden":"true"}),(0,t.jsx)("span",{className:"upload-dropzone__title",children:h?"Reemplazar archivo PDF":"Arrastra o selecciona un PDF"}),(0,t.jsx)("span",{className:"upload-dropzone__hint",children:"M\xe1x. 12 000 palabras procesadas autom\xe1ticamente"}),(0,t.jsx)("input",{id:"job-description-file",type:"file",accept:"application/pdf",onChange:j,className:"sr-only"})]}),(0,t.jsxs)("div",{className:"upload-card__status",children:[(0,t.jsx)("span",{className:"status-tag status-tag--".concat(n),children:A[n]}),"loading"===n&&(0,t.jsx)(b.Z,{size:16,className:"upload-card__icon upload-card__icon--spin"}),"ready"===n&&(0,t.jsx)(f.Z,{size:16,className:"upload-card__icon upload-card__icon--success"}),"error"===n&&(0,t.jsx)(y.Z,{size:16,className:"upload-card__icon upload-card__icon--error"})]}),(0,t.jsxs)("div",{className:"upload-card__meta","aria-live":"polite",children:["loading"===n&&(0,t.jsx)("span",{children:"Procesando PDF…"}),"ready"===n&&(0,t.jsx)("span",{children:h?"".concat(h," \xb7 ").concat(x," palabras"):"PDF listo para analizar"}),"error"===n&&o&&(0,t.jsx)("span",{className:"upload-card__error",children:o})]}),d.length>0&&(0,t.jsxs)("div",{className:"upload-card__warnings",children:[(0,t.jsx)("span",{children:"Observaciones del archivo:"}),(0,t.jsx)("ul",{children:d.map((e,a)=>(0,t.jsx)("li",{children:e},"".concat(e,"-").concat(a)))})]})]})}var F=s(3966),D=s(2176),T=s(6020);function L(e){let{isOpen:a,onClose:s,selectedModel:i,onPreviewChange:n}=e,[l,o]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(""),[p,x]=(0,r.useState)(!1),[g,j]=(0,r.useState)(null),[v,f]=(0,r.useState)(!1),y=(0,r.useRef)(null),N=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(a){var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}},[l,a]),(0,r.useEffect)(()=>{a||j(null)},[a]),(0,r.useEffect)(()=>{if(!a||v||l.length>0)return;let e=new Date().toISOString(),s={id:"".concat(e,"-assistant-welcome"),type:"assistant",message:"\xa1Hola! Soy tu asistente de IA. Estoy aqu\xed para ayudarte a interpretar el an\xe1lisis y responder dudas sobre criterios \xe9ticos.",timestamp:e};o([s]),d([{role:"assistant",content:s.message}]),f(!0)},[a,v,l.length]),(0,r.useEffect)(()=>{if(!a)return;let e=e=>{"Escape"===e.key&&s()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,s]),(0,r.useEffect)(()=>{if(!a)return;let e=e=>{N.current&&!N.current.contains(e.target)&&s()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[a,s]),(0,r.useEffect)(()=>{if(n){if(0===l.length){n([]);return}n(l.slice(-2))}},[l,n]);let _=async()=>{let e=u.trim();if(!e||p)return;let a=new Date().toISOString(),s={id:"".concat(a,"-user"),type:"user",message:e,timestamp:a};o(e=>[...e,s]),h(""),x(!0),j(null);let t=(i||"gpt-4").toLowerCase(),r=[...c,{role:"user",content:e}];try{let a=await m({message:e,modelId:t,chatHistory:r}),s=new Date().toISOString(),i={id:"".concat(s,"-assistant"),type:"assistant",message:a.message,timestamp:s};o(e=>[...e,i]),d([...r,{role:"assistant",content:a.message}])}catch(e){var n,l;j((null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(n=l.data)||void 0===n?void 0:n.detail)||"No fue posible obtener respuesta del asistente.")}finally{x(!1)}};return a?(0,t.jsx)("div",{className:"chat-floating",role:"dialog","aria-modal":"true",children:(0,t.jsxs)("div",{className:"chat-panel",ref:N,children:[(0,t.jsxs)("header",{className:"chat-header",children:[(0,t.jsxs)("div",{className:"chat-header__info",children:[(0,t.jsx)("div",{className:"chat-avatar","aria-hidden":"true",children:(0,t.jsx)(F.Z,{size:18})}),(0,t.jsx)("div",{children:(0,t.jsx)("p",{className:"chat-title",children:"Chat con IA"})})]}),(0,t.jsx)("div",{className:"chat-actions",children:(0,t.jsxs)("button",{type:"button",className:"chat-close-button",onClick:s,children:[(0,t.jsx)(C.Z,{size:16}),(0,t.jsx)("span",{children:"Cerrar"})]})})]}),(0,t.jsxs)("div",{className:"chat-body",children:[0===l.filter(e=>"user"===e.type).length&&(0,t.jsxs)("div",{className:"chat-preface",children:[(0,t.jsx)(D.Z,{size:18}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"\xbfNo sabes qu\xe9 preguntar?"}),(0,t.jsx)("p",{children:"Prueba con “\xbfQu\xe9 significa la confianza media?” o “\xbfC\xf3mo sigo con este candidato?”."})]})]}),(0,t.jsxs)("div",{className:"chat-messages","aria-live":"polite",children:[l.map(e=>(0,t.jsxs)("div",{className:"chat-bubble chat-bubble--".concat(e.type),children:[(0,t.jsx)("p",{className:"chat-bubble__text",children:e.message}),(0,t.jsx)("time",{className:"chat-bubble__time",children:new Date(e.timestamp).toLocaleTimeString()})]},e.id)),p&&(0,t.jsxs)("div",{className:"chat-bubble chat-bubble--assistant chat-bubble--pending","aria-live":"assertive",children:[(0,t.jsx)(b.Z,{className:"chat-bubble__loader",size:16}),(0,t.jsx)("span",{children:"La IA est\xe1 pensando…"})]}),(0,t.jsx)("div",{ref:y})]})]}),g&&(0,t.jsx)("div",{className:"chat-error",children:g}),(0,t.jsxs)("div",{className:"chat-input",children:[(0,t.jsx)("label",{htmlFor:"chat-message",className:"sr-only",children:"Escribe tu mensaje para el asistente de IA"}),(0,t.jsx)("textarea",{id:"chat-message",value:u,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),_())},placeholder:"Haz preguntas sobre el an\xe1lisis o los criterios aplicados…","aria-label":"Enviar mensaje al asistente"}),(0,t.jsxs)("div",{className:"chat-input__actions",children:[(0,t.jsxs)("div",{className:"chat-input__hint",children:[(0,t.jsx)(k.Z,{size:14}),(0,t.jsx)("span",{children:"Shift + Enter para salto de l\xednea"})]}),(0,t.jsxs)("button",{type:"button",className:"chat-send-button",onClick:_,disabled:p||!u.trim(),children:[p?(0,t.jsx)(b.Z,{className:"chat-send-spinner",size:16}):(0,t.jsx)(T.Z,{size:16}),(0,t.jsx)("span",{children:p?"Enviando…":"Enviar"})]})]})]})]})}):null}var B=s(4033);function O(e){let{children:a}=e,{isAuthenticated:s,isLoading:i}=(0,I.useAuth)(),n=(0,B.useRouter)();return((0,r.useEffect)(()=>{i||s||n.push("/login")},[s,i,n]),i)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(b.Z,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Cargando..."})]})}):s?(0,t.jsx)(t.Fragment,{children:a}):null}var q=s(4527),H=s(6637),U=s(9036),V=s(8063),W=s(1295),J=s(8253);function K(){let{user:e}=(0,I.useAuth)(),[a,s]=(0,r.useState)({username:"",password:"",confirmPassword:"",email:"",department:"RH",role:"user"}),[i,n]=(0,r.useState)(null),[l,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1);if((null==e?void 0:e.role)!=="admin")return null;let p=async e=>{if(e.preventDefault(),n(null),o(null),a.password!==a.confirmPassword){n("Las contrase\xf1as no coinciden");return}if(a.password.length<8){n("La contrase\xf1a debe tener al menos 8 caracteres");return}if(!a.email.endsWith("@inbursa.com")){n("El email debe ser del dominio @inbursa.com");return}if("RH"!==a.department&&"Recursos Humanos"!==a.department){n("El departamento debe ser RH o Recursos Humanos");return}d(!0);try{await h({username:a.username,password:a.password,email:a.email,department:a.department,role:a.role}),o("Usuario creado exitosamente"),s({username:"",password:"",confirmPassword:"",email:"",department:"RH",role:"user"})}catch(e){var t,r;n((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||e.message||"Error al crear usuario")}finally{d(!1)}};return(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-2 flex items-center gap-2",children:[(0,t.jsx)(q.Z,{className:"w-5 h-5"}),"Crear nuevo usuario"]}),(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Crea usuarios del departamento RH con email @inbursa.com"})]}),(0,t.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[i&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-start gap-3",children:[(0,t.jsx)(V.Z,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:"Error"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:i})]})]}),l&&(0,t.jsxs)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-start gap-3",children:[(0,t.jsx)(f.Z,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:"\xc9xito"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:l})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"username",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Usuario *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(q.Z,{className:"h-4 w-4 text-slate-400"})}),(0,t.jsx)("input",{id:"username",type:"text",value:a.username,onChange:e=>s({...a,username:e.target.value}),required:!0,className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#003b71] focus:border-[#003b71] outline-none transition",placeholder:"usuario",disabled:c,pattern:"[a-zA-Z0-9_]{3,50}",title:"3-50 caracteres, solo letras, n\xfameros y guiones bajos"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(W.Z,{className:"h-4 w-4 text-slate-400"})}),(0,t.jsx)("input",{id:"email",type:"email",value:a.email,onChange:e=>s({...a,email:e.target.value}),required:!0,className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#003b71] focus:border-[#003b71] outline-none transition",placeholder:"usuario@inbursa.com",disabled:c})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Contrase\xf1a *"}),(0,t.jsx)("input",{id:"password",type:u?"text":"password",value:a.password,onChange:e=>s({...a,password:e.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#003b71] focus:border-[#003b71] outline-none transition",placeholder:"M\xednimo 8 caracteres",disabled:c,minLength:8})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirmar contrase\xf1a *"}),(0,t.jsx)("input",{id:"confirmPassword",type:u?"text":"password",value:a.confirmPassword,onChange:e=>s({...a,confirmPassword:e.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#003b71] focus:border-[#003b71] outline-none transition",placeholder:"Repite la contrase\xf1a",disabled:c})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"showPassword",checked:u,onChange:e=>m(e.target.checked),className:"w-4 h-4 text-[#003b71] border-slate-300 rounded focus:ring-[#003b71]"}),(0,t.jsx)("label",{htmlFor:"showPassword",className:"text-sm text-slate-600",children:"Mostrar contrase\xf1as"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"department",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Departamento *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(J.Z,{className:"h-4 w-4 text-slate-400"})}),(0,t.jsxs)("select",{id:"department",value:a.department,onChange:e=>s({...a,department:e.target.value}),required:!0,className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#003b71] focus:border-[#003b71] outline-none transition bg-white",disabled:c,children:[(0,t.jsx)("option",{value:"RH",children:"RH"}),(0,t.jsx)("option",{value:"Recursos Humanos",children:"Recursos Humanos"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"role",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Rol *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(U.Z,{className:"h-4 w-4 text-slate-400"})}),(0,t.jsxs)("select",{id:"role",value:a.role,onChange:e=>s({...a,role:e.target.value}),required:!0,className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#003b71] focus:border-[#003b71] outline-none transition bg-white",disabled:c,children:[(0,t.jsx)("option",{value:"user",children:"Usuario"}),(0,t.jsx)("option",{value:"admin",children:"Administrador"})]})]})]})]}),(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,t.jsx)("strong",{children:"Requisitos de contrase\xf1a:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,t.jsx)("li",{children:"M\xednimo 8 caracteres"}),(0,t.jsx)("li",{children:"Al menos una letra may\xfascula"}),(0,t.jsx)("li",{children:"Al menos una letra min\xfascula"}),(0,t.jsx)("li",{children:"Al menos un n\xfamero"}),(0,t.jsx)("li",{children:"Al menos un car\xe1cter especial"})]})]})}),(0,t.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-gradient-to-r from-[#003b71] to-[#0b5ca8] text-white py-3 rounded-lg font-semibold hover:from-[#002d56] hover:to-[#0a4a87] focus:outline-none focus:ring-2 focus:ring-[#003b71] focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center gap-2",children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.Z,{className:"w-5 h-5 animate-spin"}),(0,t.jsx)("span",{children:"Creando usuario..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Crear usuario"})]})})]})]})}var X=s(2482),G=s(4280),Q=s(7972);function $(){let[e,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[n,l]=(0,r.useState)(null),[o,c]=(0,r.useState)({}),[d,u]=(0,r.useState)(!1),m=(0,r.useCallback)(async()=>{i(!0),l(null);try{let e=await x({username:o.username||void 0,candidate_id:o.candidate_id||void 0,action:o.action||void 0,limit:100});a(e.entries)}catch(a){var e,s;l((null==a?void 0:null===(s=a.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.detail)||"Error al cargar la bit\xe1cora"),console.error("Error cargando bit\xe1cora:",a)}finally{i(!1)}},[o]);(0,r.useEffect)(()=>{m()},[m]);let h=e=>{switch(e){case"interview":return"Pasar a entrevista";case"rejected":return"Rechazar";case"on_hold":return"En espera";default:return e}},p=e=>{switch(e){case"interview":return(0,t.jsx)(w.Z,{size:16,className:"text-green-600"});case"rejected":return(0,t.jsx)(z.Z,{size:16,className:"text-red-600"});case"on_hold":return(0,t.jsx)(S.Z,{size:16,className:"text-slate-500"});default:return null}},g=e=>{try{let a=new Date(e);return new Intl.DateTimeFormat("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch(a){return e}};return(0,t.jsxs)("section",{className:"card",style:{marginTop:"2rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"section-title",style:{marginBottom:"0.5rem"},children:"Bit\xe1cora de Acciones"}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Historial completo de acciones realizadas sobre candidatos"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,t.jsxs)("button",{type:"button",onClick:()=>u(!d),className:"btn-outline",style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:[(0,t.jsx)(X.Z,{size:16,style:{marginRight:"0.5rem"}}),"Filtros"]}),(0,t.jsx)("button",{type:"button",onClick:m,className:"btn-outline",style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},disabled:s,children:(0,t.jsx)(G.Z,{size:16,className:s?"animate-spin":""})})]})]}),d&&(0,t.jsxs)("div",{style:{padding:"1rem",background:"rgba(0, 59, 113, 0.03)",borderRadius:"0.75rem",marginBottom:"1.5rem",border:"1px solid rgba(0, 59, 113, 0.1)"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,t.jsx)("strong",{children:"Filtros"}),(0,t.jsx)("button",{type:"button",onClick:()=>{c({}),u(!1)},style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Limpiar"})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",fontWeight:600},children:"Usuario"}),(0,t.jsx)("input",{type:"text",value:o.username||"",onChange:e=>c(a=>({...a,username:e.target.value||void 0})),placeholder:"Filtrar por usuario",style:{width:"100%",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid #cbd5f5",fontSize:"0.875rem"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",fontWeight:600},children:"Candidato"}),(0,t.jsx)("input",{type:"text",value:o.candidate_id||"",onChange:e=>c(a=>({...a,candidate_id:e.target.value||void 0})),placeholder:"Filtrar por candidato",style:{width:"100%",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid #cbd5f5",fontSize:"0.875rem"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"0.5rem",fontWeight:600},children:"Acci\xf3n"}),(0,t.jsxs)("select",{value:o.action||"",onChange:e=>c(a=>({...a,action:e.target.value||void 0})),style:{width:"100%",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid #cbd5f5",fontSize:"0.875rem",background:"white"},children:[(0,t.jsx)("option",{value:"",children:"Todas"}),(0,t.jsx)("option",{value:"interview",children:"Pasar a entrevista"}),(0,t.jsx)("option",{value:"rejected",children:"Rechazar"}),(0,t.jsx)("option",{value:"on_hold",children:"En espera"})]})]})]})]}),n&&(0,t.jsx)("div",{style:{padding:"1rem",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"0.75rem",color:"#dc2626",marginBottom:"1rem"},children:n}),s?(0,t.jsxs)("div",{style:{textAlign:"center",padding:"2rem"},children:[(0,t.jsx)(G.Z,{className:"animate-spin mx-auto mb-2",size:24}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Cargando bit\xe1cora..."})]}):0===e.length?(0,t.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:[(0,t.jsx)(H.Z,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"No hay registros en la bit\xe1cora"})]}):(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:e.map((e,a)=>(0,t.jsxs)("div",{style:{padding:"1rem",background:"white",borderRadius:"0.75rem",border:"1px solid rgba(148, 163, 184, 0.2)",display:"flex",gap:"1rem",alignItems:"start"},children:[(0,t.jsx)("div",{style:{padding:"0.5rem",background:"interview"===e.action?"rgba(0, 168, 89, 0.1)":"rejected"===e.action?"rgba(239, 68, 68, 0.1)":"rgba(148, 163, 184, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:p(e.action)}),(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.5rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{style:{fontSize:"0.95rem"},children:h(e.action)}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"0.25rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:[(0,t.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,t.jsx)(H.Z,{size:14}),e.candidate_filename]}),(0,t.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,t.jsx)(Q.Z,{size:14}),e.username]})]})]}),(0,t.jsxs)("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,t.jsx)(S.Z,{size:12}),g(e.timestamp)]})]}),e.notes&&(0,t.jsx)("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginTop:"0.5rem",fontStyle:"italic"},children:e.notes})]})]},a))}),e.length>0&&(0,t.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid rgba(148, 163, 184, 0.2)",textAlign:"center",fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Mostrando ",e.length," registro",1!==e.length?"s":""]})]})}function Y(){let{user:e}=(0,I.useAuth)(),[a,s]=(0,r.useState)("none");if((null==e?void 0:e.role)!=="admin")return null;let i=[{id:"create-user",label:"Crear Usuario",icon:q.Z},{id:"audit-log",label:"Bit\xe1cora",icon:H.Z}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{background:"linear-gradient(135deg, var(--brand-primary, #003b71), var(--brand-accent, #0b5ca8))",padding:"0.75rem 2rem",display:"flex",alignItems:"center",gap:"1.5rem",boxShadow:"0 2px 8px rgba(0, 59, 113, 0.15)",marginBottom:"2rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"white"},children:[(0,t.jsx)(U.Z,{size:18}),(0,t.jsx)("span",{style:{fontWeight:600,fontSize:"0.9rem"},children:"Administraci\xf3n"})]}),(0,t.jsx)("div",{style:{display:"flex",gap:"0.5rem",flex:1},children:i.map(e=>{let r=e.icon;return(0,t.jsxs)("button",{type:"button",onClick:()=>s(e.id),style:{padding:"0.625rem 1.25rem",background:a===e.id?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"white",fontWeight:a===e.id?600:500,transition:"all 0.2s"},onMouseEnter:s=>{a!==e.id&&(s.currentTarget.style.background="rgba(255, 255, 255, 0.15)")},onMouseLeave:s=>{a!==e.id&&(s.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:[(0,t.jsx)(r,{size:16}),(0,t.jsx)("span",{children:e.label})]},e.id)})})]}),"none"!==a&&(0,t.jsx)("section",{className:"workspace",style:{marginTop:"2rem"},children:(0,t.jsx)("div",{className:"workspace__primary",children:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"1px solid rgba(148, 163, 184, 0.2)"},children:[(0,t.jsx)("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:700,color:"var(--brand-primary, #003b71)"},children:"create-user"===a?"Crear Usuario":"Bit\xe1cora de Acciones"}),(0,t.jsx)("button",{type:"button",onClick:()=>{s("none")},style:{background:"none",border:"none",cursor:"pointer",padding:"0.5rem",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-secondary)",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(0, 0, 0, 0.05)",e.currentTarget.style.color="var(--text-primary)"},onMouseLeave:e=>{e.currentTarget.style.background="none",e.currentTarget.style.color="var(--text-secondary)"},children:(0,t.jsx)(C.Z,{size:20})})]}),"create-user"===a&&(0,t.jsx)(K,{}),"audit-log"===a&&(0,t.jsx)($,{})]})})})]})}var ee=s(5883),ea=s(6840),es=s(8291);let et="gpt-4",er={high:92,medium:76,low:58,insufficient:45};function ei(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:90,s=e.trim().replace(/\s+/g," ");return s.length<=a?s:"".concat(s.slice(0,a).trim(),"…")}function en(){var e;let{user:a,logout:s}=(0,I.useAuth)(),[i,l]=(0,r.useState)(""),[o,c]=(0,r.useState)([]),[u,m]=(0,r.useState)([]),[h,p]=(0,r.useState)(null),[x,g]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[f,y]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&e.shiftKey&&"m"===e.key.toLowerCase()&&(e.preventDefault(),b(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let N=(0,r.useMemo)(()=>!!i.trim()&&o.length>0,[i,o.length]),w=(0,r.useMemo)(()=>{if(!u.length)return null;let e=u.map(e=>({result:e,score:function(e){var a;let s=null!==(a=er[e.confidence_level])&&void 0!==a?a:70;return Math.max(30,Math.min(100,Math.round(s-(e.missing_information&&e.missing_information.length>0?10:0)+(e.objective_criteria.length>=3?5:0))))}(e)})),a=Math.max(...e.map(e=>e.score)),s=e.filter(e=>e.score===a);return{average:Math.round(e.reduce((e,a)=>e+a.score,0)/Math.max(1,e.length)),bestMatches:s,maxScore:a,flagged:u.filter(e=>!1===e.ethical_compliance).length}},[u]),z=(0,r.useMemo)(()=>[...f].reverse().find(e=>"assistant"===e.type)||null,[f]),S=(0,r.useMemo)(()=>[...f].reverse().find(e=>"user"===e.type)||null,[f]);z&&ei(z.message),S&&ei(S.message,70);let C=async()=>{if(!N){p("Carga la descripci\xf3n del puesto y al menos un CV para habilitar el an\xe1lisis.");return}try{g(!0),p(null);let e=await d({jobDescription:i,candidates:o,modelId:et});m(e)}catch(s){var e,a;p((null==s?void 0:null===(a=s.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.detail)||"No fue posible generar el an\xe1lisis. Intenta nuevamente."),m([])}finally{g(!1)}},E=(0,r.useMemo)(()=>{var e;let s=null==a?void 0:null===(e=a.username)||void 0===e?void 0:e.trim();if(!s)return"Usuario";if(s.includes("@")){let[e]=s.split("@");return e||s}return s},[null==a?void 0:a.username]),P=E.charAt(0).toUpperCase(),A=(null==a?void 0:a.email)||((null==a?void 0:null===(e=a.username)||void 0===e?void 0:e.includes("@"))?null==a?void 0:a.username:void 0);return(0,t.jsx)(O,{children:(0,t.jsxs)("main",{className:"page-shell",children:[(0,t.jsx)(Y,{}),(0,t.jsxs)("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center w-full justify-between md:justify-start gap-4 bg-white border border-slate-200 rounded-2xl shadow-sm p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-[#003b71] to-[#0b5ca8] flex items-center justify-center text-white text-xl font-semibold shadow-inner",children:P}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-base font-semibold text-slate-900 leading-tight",children:E}),A&&(0,t.jsxs)("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,t.jsx)(W.Z,{size:12}),A]})]})]}),(null==a?void 0:a.role)&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs font-semibold bg-slate-100 text-slate-700 px-2.5 py-1 rounded-full border border-slate-200",children:[(0,t.jsx)(U.Z,{size:12}),a.role.toUpperCase()]})]}),(0,t.jsxs)("button",{onClick:s,className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-semibold text-slate-700 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 hover:border-slate-300 hover:text-slate-900 transition-all duration-200 shadow-sm hover:shadow-md self-start md:self-auto",children:[(0,t.jsx)(ee.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Cerrar sesi\xf3n"})]})]}),(0,t.jsxs)("header",{className:"hero","aria-labelledby":"intro",children:[(0,t.jsxs)("div",{className:"hero__content",children:[(0,t.jsx)("div",{className:"hero__logo hero__logo--large",children:(0,t.jsx)(n(),{src:"/logo.png",alt:"agente-rh",fill:!0,priority:!0,style:{objectFit:"contain"},sizes:"320px"})}),(0,t.jsx)("h1",{id:"intro",className:"hero__title",children:"Analiza talento con foco \xe9tico y precisi\xf3n cuantitativa"}),(0,t.jsx)("p",{className:"hero__description",children:"Carga la descripci\xf3n del puesto y los CVs en PDF. Nuestro asistente genera comparativos objetivos, destaca riesgos \xe9ticos y te acompa\xf1a en la toma de decisiones."}),(0,t.jsxs)("div",{className:"hero__pills",role:"list",children:[(0,t.jsxs)("span",{role:"listitem",children:[(0,t.jsx)(Z.Z,{size:16})," Cumplimiento \xe9tico automatizado"]}),(0,t.jsxs)("span",{role:"listitem",children:[(0,t.jsx)(ea.Z,{size:16})," Puntajes comparativos inmediatos"]}),(0,t.jsxs)("span",{role:"listitem",children:[(0,t.jsx)(k.Z,{size:16})," Flujos guiados en 3 pasos"]})]}),(0,t.jsx)("div",{className:"hero__actions",children:(0,t.jsxs)("button",{type:"button",className:"btn-outline hero__chat",onClick:()=>b(!0),children:[(0,t.jsx)(D.Z,{size:18}),(0,t.jsx)("span",{children:"Abrir chat con IA"})]})})]}),(0,t.jsxs)("aside",{className:"hero-sidecard","aria-label":"Ruta guiada del proceso",children:[(0,t.jsx)("p",{className:"hero-sidecard__title",children:"Ruta guiada"}),(0,t.jsxs)("ul",{className:"hero-sidecard__list",children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("div",{className:"hero-sidecard__icon","aria-hidden":"true",children:(0,t.jsx)(H.Z,{size:18})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Job Description"}),(0,t.jsx)("span",{children:"Sube el PDF para extraer criterios clave."})]})]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("div",{className:"hero-sidecard__icon","aria-hidden":"true",children:(0,t.jsx)(j.Z,{size:18})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"CVs de talento"}),(0,t.jsx)("span",{children:"Procesa varios curr\xedculums en segundos."})]})]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("div",{className:"hero-sidecard__icon","aria-hidden":"true",children:(0,t.jsx)(ea.Z,{size:18})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Insight accionable"}),(0,t.jsx)("span",{children:"Obt\xe9n s\xedntesis y puntajes comparativos."})]})]})]}),(0,t.jsxs)("div",{className:"hero-sidecard__footer",children:[(0,t.jsx)(Z.Z,{size:16,"aria-hidden":"true"}),(0,t.jsx)("span",{children:"Procesamiento seguro bajo est\xe1ndares agente-rh."})]})]})]}),(0,t.jsx)("section",{className:"workspace",children:(0,t.jsxs)("div",{className:"workspace__primary",children:[(0,t.jsxs)("div",{className:"intake-grid",children:[(0,t.jsx)(M,{jobDescription:i,onJobDescriptionChange:e=>{l(e),m([])}}),(0,t.jsx)(_,{onCandidatesChange:e=>{c(e),m([])}})]}),(0,t.jsxs)("section",{className:"analysis-callout card".concat(x?" analysis-callout--loading":""),"aria-live":"polite",children:[(0,t.jsxs)("div",{className:"analysis-callout__info",children:[(0,t.jsx)(k.Z,{size:18,"aria-hidden":"true"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Genera tu an\xe1lisis inteligente"}),(0,t.jsx)("p",{children:"La IA prioriza los criterios objetivos del JD contra cada CV en segundos."})]})]}),(0,t.jsxs)("button",{type:"button",className:"btn-primary btn-primary--large",onClick:C,disabled:!N||x,children:[x?"Analizando…":"Generar an\xe1lisis",(0,t.jsx)(es.Z,{size:16})]}),!N&&!x&&(0,t.jsx)("p",{className:"analysis-callout__hint",children:"Carga la descripci\xf3n del puesto y al menos un CV para habilitar el an\xe1lisis."})]}),h&&(0,t.jsx)("div",{role:"alert",className:"alert alert--error",children:h}),w&&(0,t.jsxs)("section",{className:"card analysis-summary","aria-label":"Resumen del an\xe1lisis",children:[(0,t.jsxs)("div",{className:"analysis-summary__item",children:[(0,t.jsx)("span",{className:"analysis-summary__label",children:"Puntaje promedio"}),(0,t.jsx)("strong",{children:w.average})]}),(0,t.jsxs)("div",{className:"analysis-summary__item",children:[(0,t.jsx)("span",{className:"analysis-summary__label",children:"Mejor match"}),(0,t.jsx)("div",{children:1===w.bestMatches.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("strong",{children:w.bestMatches[0].result.candidateId||w.bestMatches[0].result.filename}),(0,t.jsxs)("span",{children:[w.maxScore,"/100"]})]}):(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem"},children:[(0,t.jsxs)("span",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.25rem"},children:[w.bestMatches.length," empates (",w.maxScore,"/100)"]}),w.bestMatches.map((e,a)=>(0,t.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,t.jsx)("strong",{style:{fontSize:"0.9rem"},children:e.result.candidateId||e.result.filename})},a))]})})]}),(0,t.jsxs)("div",{className:"analysis-summary__item analysis-summary__item--accent",children:[(0,t.jsx)("span",{className:"analysis-summary__label",children:"Alertas \xe9ticas"}),(0,t.jsx)("strong",{children:w.flagged})]})]}),(0,t.jsx)(R,{results:u})]})}),(0,t.jsx)(L,{isOpen:v,onClose:()=>b(!1),selectedModel:et,onPreviewChange:y})]})})}},2406:function(e,a,s){"use strict";s.r(a),s.d(a,{AuthProvider:function(){return u},useAuth:function(){return m}});var t=s(7437),r=s(2265),i=s(4033),n=s(2601);let l=(0,r.createContext)(void 0),o=n.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",c="agente-rh-token",d="agente-rh-user";function u(e){let{children:a}=e,[s,n]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[h,p]=(0,r.useState)(!0),x=(0,i.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem(c),a=localStorage.getItem(d);if(e&&a)try{m(e),n(JSON.parse(a))}catch(e){console.error("Error parsing stored user:",e),localStorage.removeItem(c),localStorage.removeItem(d)}p(!1)},[]);let g=async(e,a)=>{try{let r;let i=new AbortController,l=setTimeout(()=>{i.abort()},3e4);try{r=await fetch("".concat(o,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:a}),signal:i.signal}),clearTimeout(l)}catch(e){var s,t;if(clearTimeout(l),"AbortError"===e.name)throw Error("La petici\xf3n tard\xf3 demasiado. El servidor puede estar lento o no disponible.");if((null===(s=e.message)||void 0===s?void 0:s.includes("Failed to fetch"))||(null===(t=e.message)||void 0===t?void 0:t.includes("NetworkError")))throw Error("No se pudo conectar con el servidor. Verifica que el backend est\xe9 funcionando.");throw e}if(!r.ok){let e="Error al iniciar sesi\xf3n";try{e=(await r.json()).detail||e}catch(a){e="Error ".concat(r.status,": ").concat(r.statusText)}throw Error(e)}let u=await r.json();localStorage.setItem(c,u.access_token),localStorage.setItem(d,JSON.stringify(u.user)),document.cookie="agente-rh-token=".concat(u.access_token,"; path=/; max-age=").concat(28800,"; SameSite=Lax"),m(u.access_token),n(u.user),await new Promise(e=>setTimeout(e,100)),window.location.href="/"}catch(e){throw console.error("Login error:",e),e}};return(0,t.jsx)(l.Provider,{value:{user:s,token:u,login:g,logout:()=>{localStorage.removeItem(c),localStorage.removeItem(d),document.cookie="agente-rh-token=; path=/; max-age=0",m(null),n(null),x.push("/login")},isLoading:h,isAuthenticated:!!u&&!!s},children:a})}function m(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[786,268,971,938,744],function(){return e(e.s=1035)}),_N_E=e.O()}]);